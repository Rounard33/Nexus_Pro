<section class="testimonial-slider">
  <div class="container">
    <div class="section-header">
      <h2>Ce que disent nos clients</h2>
      <p>Découvrez les témoignages de nos clients satisfaits</p>
    </div>

    <div class="slider-container">
      <div class="testimonial-card" [class.active]="i === currentIndex" *ngFor="let testimonial of testimonials; let i = index">
        <div class="testimonial-content">
          <div class="quote-icon">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
              <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h4v10h-9z"/>
            </svg>
          </div>
          
          <blockquote class="testimonial-text">
            "{{ testimonial.content }}"
          </blockquote>

          <div class="testimonial-rating">
            <span class="star" *ngFor="let star of getStars(testimonial.rating)">★</span>
          </div>

          <div class="testimonial-author">
            <div class="author-avatar">
              <img 
                [src]="testimonial.avatar" 
                [alt]="testimonial.name" 
                (load)="onImageLoad(testimonial)"
                (error)="onImageError($event, testimonial)"
                [style.display]="testimonial.imageLoaded ? 'block' : 'none'">
              <div class="avatar-fallback" [style.display]="!testimonial.imageLoaded ? 'flex' : 'none'">
                {{ testimonial.name.charAt(0) }}
              </div>
            </div>
            <div class="author-info">
              <h4 class="author-name">{{ testimonial.name }}</h4>
              <p class="author-role">{{ testimonial.role }}</p>
              <p class="author-company">{{ testimonial.company }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Navigation -->
      <div class="slider-navigation">
        <button class="nav-btn prev" (click)="previousSlide()" (mouseenter)="stopAutoSlide()" (mouseleave)="startAutoSlide()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
          </svg>
        </button>
        <button class="nav-btn next" (click)="nextSlide()" (mouseenter)="stopAutoSlide()" (mouseleave)="startAutoSlide()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
          </svg>
        </button>
      </div>

      <!-- Dots -->
      <div class="slider-dots">
        <button 
          class="dot" 
          [class.active]="i === currentIndex" 
          *ngFor="let testimonial of testimonials; let i = index"
          (click)="goToSlide(i)"
          (mouseenter)="stopAutoSlide()" 
          (mouseleave)="startAutoSlide()"
        ></button>
      </div>
    </div>
  </div>
</section>
