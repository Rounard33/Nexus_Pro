<div class="hours">
  <div class="page-header">
    <h1 class="page-title">Gestion des horaires</h1>
    <button 
      class="btn btn-primary" 
      (click)="saveAll()" 
      [disabled]="isSaving"
      *ngIf="hasAnyChanges()">
      {{ isSaving ? 'Sauvegarde...' : 'Tout sauvegarder' }}
    </button>
  </div>

  <!-- Messages -->
  <div class="message-success" *ngIf="saveSuccess">
    <span>✓</span>
    <p>Horaires sauvegardés avec succès !</p>
  </div>

  <div class="message-error" *ngIf="saveError">
    <span>⚠️</span>
    <p>{{ saveError }}</p>
  </div>

  <div class="loading-state" *ngIf="isLoading">
    <p>Chargement des horaires...</p>
  </div>

  <!-- Liste des horaires -->
  <div class="hours-list" *ngIf="!isLoading">
    <div class="hours-card" *ngFor="let day of openingHours">
      <div class="hours-header">
        <div class="day-info">
          <h3 class="day-name">{{ getDayName(day.day_of_week) }}</h3>
          <label class="day-toggle">
            <input 
              type="checkbox" 
              [(ngModel)]="editedHours[day.day_of_week.toString()].is_active"
              [disabled]="!day.id">
            <span>Jour actif</span>
          </label>
        </div>
      </div>

      <div class="hours-body">
        <div class="form-group">
          <label class="form-label">Périodes d'ouverture</label>
          <input 
            type="text" 
            class="form-input"
            [(ngModel)]="editedHours[day.day_of_week.toString()].periods"
            placeholder="Ex: 9h-13h | 14h-17h"
            [disabled]="!day.id || !editedHours[day.day_of_week.toString()].is_active">
          <p class="form-hint">Format: 9h-13h | 14h-17h (séparer les périodes par |)</p>
        </div>

        <div class="form-group">
          <label class="form-label">Dernier rendez-vous</label>
          <input 
            type="text" 
            class="form-input"
            [(ngModel)]="editedHours[day.day_of_week.toString()].last_appointment"
            placeholder="Ex: 16h"
            [disabled]="!day.id || !editedHours[day.day_of_week.toString()].is_active">
          <p class="form-hint">Heure du dernier créneau réservable (ex: 16h ou 16h30)</p>
        </div>

        <div class="hours-actions">
          <button 
            class="btn btn-secondary" 
            (click)="saveDay(day)" 
            [disabled]="isSaving || !day.id || !hasChanges(day)">
            {{ isSaving ? 'Sauvegarde...' : 'Sauvegarder' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

